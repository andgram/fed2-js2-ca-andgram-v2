import{a as d}from"./authGuard-C2GFzsuy.js";import{g as c,s as m}from"./setTitle-DgJNIb0L.js";import{a as f}from"./read-DVWSykXA.js";import{A as l,h as u,d as i}from"./displayMessage-CqJwHQFs.js";import"./auth-fjUhtDne.js";async function g(o,{title:t,body:e}){const r=JSON.stringify({title:t,body:e}),s=await fetch(`${l}/${o}`,{method:"PUT",body:r,headers:u()}),a=await s.json();if(s.ok===!1)throw new Error(a.errors[0].message);return a}async function p(o){o.preventDefault();const t=o.target,e=new FormData(t);Object.fromEntries(e.entries());const r=e.get("id"),s=e.get("title"),a=e.get("body");try{await g(r,{title:s,body:a}),i("#message","success","Post updated succesdfully."),t.reset(),setTimeout(()=>{window.location.href="/profile/"},2e3)}catch(n){i("#message","error",n.message)}}d();async function y(){const o=c("id");o||(window.location.href="/");try{const t=await f(o);m(`Editing ${t.data.title}`);const e=document.forms.editPost;e.id.value=t.data.id,e.title.value=t.data.title,e.body.value=t.data.body,e.addEventListener("submit",p)}catch(t){console.error(t),i("#message","error",t.message)}}y();
