import{a as l}from"./read-DVWSykXA.js";import{A as m,h as u,d}from"./displayMessage-CqJwHQFs.js";import{b as f}from"./auth-fjUhtDne.js";import{g as p,s as h}from"./setTitle-DgJNIb0L.js";async function y(e){if((await fetch(`${m}/${e}`,{method:"DELETE",headers:u()})).ok===!1)throw new Error("Delete failed")}async function c(e){if(e.preventDefault(),confirm("Are you sure you want to delete this post?")){const t=e.target,{id:o}=t.dataset;try{await y(o),t.removeEventListener("click",c);const s=t.closest("a.post");s&&s.remove(),d("#message","success","Post deleted successfully."),setTimeout(()=>{window.location.href="/profile/"},2e3)}catch(s){console.error("Error deleting post: ",s.message),d("#message","error",s.message)}}}function E(e){const t=f(),{author:o,id:s}=e;if(o.name!==t)return null;const n=document.createElement("div");n.classList.add("admin-buttons","flex","space-x-4","mt-4");const a=document.createElement("a");a.innerText="Edit",a.href=`/post/edit/?id=${s}`,a.className="text-blue-600 hover:text-blue-800 font-semibold transition duration-200";const r=document.createElement("button");return r.innerText="Delete",r.dataset.id=s,r.addEventListener("click",c),r.className="text-red-600 hover:text-red-800 font-semibold transition duration-200",n.appendChild(a),n.appendChild(r),n}function x(e,t){e.innerHTML="";const{title:o,body:s}=t,i=E(t);i&&e.appendChild(i);const n=document.createElement("h1");n.innerText=o,n.className="text-4xl font-bold text-gray-800 mb-4",e.appendChild(n);const a=document.createElement("p");a.innerText=s,a.className="text-gray-700 mb-6",e.appendChild(a)}async function b(){const e=p("id");e||(window.location.href="/");const t=document.querySelector("#post");try{const o=await l(e);h(o.data.title),x(t,o.data)}catch(o){console.error(o),d(t,"error",o.message)}}b();
